(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{1222:function(a,t,s){"use strict";s.r(t);var e=s(3),r=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("p",[a._v("需求：项目使用SpringBoot进行开发，我们需要实现当代码提交到git仓库，我们点击Jenkins开始构建按钮，能自动拉取代码并使用maven执行打包操作，上传到指定服务器并运行。")]),a._v(" "),t("blockquote",[t("p",[a._v("版本为：Jenkins 2.414.3")])]),a._v(" "),t("h2",{attrs:{id:"安装maven插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装maven插件"}},[a._v("#")]),a._v(" 安装maven插件")]),a._v(" "),t("p",[t("img",{attrs:{src:s(563),alt:"image-20231112181659157"}})]),a._v(" "),t("p",[a._v("搜索maven找到插件并安装")]),a._v(" "),t("p",[t("img",{attrs:{src:s(564),alt:"image-20231112181618246"}})]),a._v(" "),t("h2",{attrs:{id:"配置maven"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置maven"}},[a._v("#")]),a._v(" 配置Maven")]),a._v(" "),t("p",[t("img",{attrs:{src:s(565),alt:"image-20231112182116162"}})]),a._v(" "),t("p",[a._v("进入全局工具配置后滑动到最底部，找到新增Maven，取消勾选自动安装，手动输入安装maven的地址，然后点击保存即可。")]),a._v(" "),t("p",[t("img",{attrs:{src:s(566),alt:"image-20231112194557424"}})]),a._v(" "),t("h2",{attrs:{id:"新建maven项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#新建maven项目"}},[a._v("#")]),a._v(" 新建maven项目")]),a._v(" "),t("p",[t("img",{attrs:{src:s(567),alt:"image-20231112194648498"}})]),a._v(" "),t("p",[a._v("选择构建一个maven项目")]),a._v(" "),t("p",[t("img",{attrs:{src:s(568),alt:"image-20231112194803024"}})]),a._v(" "),t("h3",{attrs:{id:"配置git地址"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置git地址"}},[a._v("#")]),a._v(" 配置git地址")]),a._v(" "),t("p",[t("img",{attrs:{src:s(569),alt:"image-20231112195342965"}})]),a._v(" "),t("p",[a._v("配置Credentials")]),a._v(" "),t("p",[a._v("用户名填写gitlab/gitee账号，这里随便填写的名字，勾选上名字保护（Treat username as secret）,在确定之后名会展示成加密。")]),a._v(" "),t("p",[t("img",{attrs:{src:s(570),alt:"image-20231112230459858"}})]),a._v(" "),t("h3",{attrs:{id:"设置pom文件地址"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置pom文件地址"}},[a._v("#")]),a._v(" 设置pom文件地址")]),a._v(" "),t("p",[a._v("如果pom文件不在项目根目录下，比如在project目录下，输入project/pom.xml")]),a._v(" "),t("p",[t("img",{attrs:{src:s(571),alt:"image-20231112195430263"}})]),a._v(" "),t("h2",{attrs:{id:"开始构建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开始构建"}},[a._v("#")]),a._v(" 开始构建")]),a._v(" "),t("p",[a._v("此时返回主面板点击运行按钮")]),a._v(" "),t("p",[t("img",{attrs:{src:s(572),alt:"image-20231112201243236"}})]),a._v(" "),t("p",[a._v("如果构建失败可以查看控制台输出，构建失败的原因可能是jdk版本、maven依赖拉取失败等等。")]),a._v(" "),t("p",[t("img",{attrs:{src:s(573),alt:"image-20231112201416559"}})]),a._v(" "),t("h2",{attrs:{id:"安装用于上传jar包的插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装用于上传jar包的插件"}},[a._v("#")]),a._v(" 安装用于上传jar包的插件")]),a._v(" "),t("p",[a._v("在插件市场搜索 Publish Over 进行安装")]),a._v(" "),t("p",[t("img",{attrs:{src:s(574),alt:"image-20231112201509675"}})]),a._v(" "),t("h2",{attrs:{id:"配置项目构建完成后上传jar包到指定服务器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置项目构建完成后上传jar包到指定服务器"}},[a._v("#")]),a._v(" 配置项目构建完成后上传jar包到指定服务器")]),a._v(" "),t("p",[t("img",{attrs:{src:s(575),alt:"image-20231112201946676"}})]),a._v(" "),t("p",[a._v("在系统配置中新增SSH连接信息")]),a._v(" "),t("p",[t("img",{attrs:{src:s(576),alt:"image-20231112202740850"}})]),a._v(" "),t("p",[a._v("配置ssh服务器，Name：服务器名称、Hostname：服务器地址、Username：登录账户")]),a._v(" "),t("p",[t("img",{attrs:{src:s(577),alt:"image-20231112202818848"}})]),a._v(" "),t("p",[a._v("点击高级按钮，然后输入密码")]),a._v(" "),t("p",[t("img",{attrs:{src:s(578),alt:"image-20231112204728306"}})]),a._v(" "),t("p",[a._v("回到项目的插件配置，配置在项目构建后上传jar包到指定服务器")]),a._v(" "),t("p",[t("img",{attrs:{src:s(579),alt:"image-20231112203500570"}})]),a._v(" "),t("p",[t("img",{attrs:{src:s(580),alt:"image-20231112204728306"}})]),a._v(" "),t("p",[a._v("SSH Server——Name：选择创建的SSH连接。")]),a._v(" "),t("p",[a._v("Transfers Set——Source files：利用通配符找到maven打包后生成的jar包，聚合工程可以写"),t("code",[a._v("**/system/*.jar")]),a._v("。")]),a._v(" "),t("p",[a._v("Transfers Set——Remove prefix：上传文件后省略的路径，例如路径有/jenkins/target会自动忽略。")]),a._v(" "),t("p",[a._v("Transfers Set——Remove directory：上传文件到指定目录。")]),a._v(" "),t("p",[a._v("Transfers Set——Exec command：运行jar包的路径，如果不确定上传后jar包的位置，可以先省略，运行一次后查看控制台日志中的路径。jar包的名称可以使用匹配符，毕竟版本是变化的。")]),a._v(" "),t("p",[a._v("启动jar包指定日志输出文件")]),a._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("nohup")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("java")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-jar")]),a._v(" /var/lib/jenkins/workspace/springbootTestFirst/jenkins/target/jenkins-*.jar "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("mylog.log "),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[a._v("2")]),a._v(">")]),t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[a._v("&1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h2",{attrs:{id:"jenkins配置ssh超时连接时间"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins配置ssh超时连接时间"}},[a._v("#")]),a._v(" Jenkins配置SSH超时连接时间")]),a._v(" "),t("p",[a._v("点击高级选项，如果超过了这个时间，jenkins会认为上传失败。")]),a._v(" "),t("p",[t("img",{attrs:{src:s(581),alt:"image-20231112224804918"}})]),a._v(" "),t("p",[a._v("参考资料")]),a._v(" "),t("p",[a._v("[1]. https://blog.gitee.com/2020/12/15/gitee-jenkins/")]),a._v(" "),t("p",[a._v("[2]. https://blog.csdn.net/qq_20957669/article/details/128662560")]),a._v(" "),t("p",[a._v("[3]. https://segmentfault.com/a/1190000020374673")])])}),[],!1,null,null,null);t.default=r.exports},563:function(a,t,s){a.exports=s.p+"assets/img/image-20231112181659157.a40dbe9f.png"},564:function(a,t,s){a.exports=s.p+"assets/img/image-20231112181618246.d60426b3.png"},565:function(a,t,s){a.exports=s.p+"assets/img/image-20231112182116162.d36f16b9.png"},566:function(a,t,s){a.exports=s.p+"assets/img/image-20231112194557424.552380fd.png"},567:function(a,t,s){a.exports=s.p+"assets/img/image-20231112194648498.ba7c910a.png"},568:function(a,t,s){a.exports=s.p+"assets/img/image-20231112194803024.6205ff92.png"},569:function(a,t,s){a.exports=s.p+"assets/img/image-20231112195342965.800a3d61.png"},570:function(a,t,s){a.exports=s.p+"assets/img/image-20231112230459858.8300e6a4.png"},571:function(a,t,s){a.exports=s.p+"assets/img/image-20231112195430263.6e343f70.png"},572:function(a,t,s){a.exports=s.p+"assets/img/image-20231112201243236.c3a40202.png"},573:function(a,t,s){a.exports=s.p+"assets/img/image-20231112201416559.07cc80e0.png"},574:function(a,t,s){a.exports=s.p+"assets/img/image-20231112201509675.13b6087e.png"},575:function(a,t,s){a.exports=s.p+"assets/img/image-20231112201946676.891c3398.png"},576:function(a,t,s){a.exports=s.p+"assets/img/image-20231112202740850.2317222a.png"},577:function(a,t,s){a.exports=s.p+"assets/img/image-20231112202818848.f467822b.png"},578:function(a,t,s){a.exports=s.p+"assets/img/image-20231112210939521.7f4baf36.png"},579:function(a,t,s){a.exports=s.p+"assets/img/image-20231112203500570.6f49cd2d.png"},580:function(a,t,s){a.exports=s.p+"assets/img/image-20231112204728306.20f558de.png"},581:function(a,t,s){a.exports=s.p+"assets/img/image-20231112224804918.54c7428f.png"}}]);